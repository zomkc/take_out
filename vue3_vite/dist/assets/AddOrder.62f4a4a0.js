import{E as A}from"./base.c25e0513.js";import{E as C}from"./el-image-viewer.1cd1e6d1.js";/* empty css                */import{g as y}from"./address.5f5e8702.js";import{a as I,i as P,_ as S}from"./noImg.824154f6.js";import{b as k}from"./order.ab82c440.js";import{_ as b,ab as h,o as c,j as l,q as s,d as _,w as u,s as p,l as i,P as x,ac as T,p as m,k as E,ae as N,af as F}from"./index.7da13a9a.js";import{E as V}from"./index.b3fbc379.js";import"./index.6b881f85.js";import"./index.03900eea.js";const B={components:{ElConfigProvider:V},data(){return{address:{phone:"",consignee:"",detail:"",sex:"1",userId:sessionStorage.getItem("userId")},finishTime:"",cartData:[],note:""}},computed:{goodsNum(){let e=0;return this.cartData.forEach(o=>{e+=o.number}),e<99?e:"99+"},goodsPrice(){let e=0;return this.cartData.forEach(o=>{e+=o.number*o.amount}),e}},created(){this.initData()},methods:{goBack(){history.go(-1)},initData(){this.defaultAddress(),this.getCartData()},async defaultAddress(){const e=await y(this.address.userId);e.data.code===1?(this.address=e.data.data,this.getFinishTime()):window.requestAnimationFrame(()=>{this.$router.push("/addressedit")})},getFinishTime(){let e=new Date,o=e.getHours()+1,n=e.getMinutes();o.toString().length<2&&(o="0"+o),n.toString().length<2&&(n="0"+n),this.finishTime=o+":"+n},toAddressPage(){window.requestAnimationFrame(()=>{this.$router.push("/address")})},async getCartData(){const e=await I({userId:this.address.userId});e.data.code===1?this.cartData=e.data.data:console.log(e.data.console.error)},async goToPaySuccess(){const e={remark:this.note,payMethod:1,addressBookId:this.address.id,userId:this.address.userId},o=await k(e);o.data.code===1?window.requestAnimationFrame(()=>{this.$router.push("/order")}):console.log(o.data.console.error)},imgPathConvert(e){return P(e)}}},d=e=>(N("data-v-dd5688b0"),e=e(),F(),e),L={id:"add_order",class:"app"},q={class:"divHead"},M={class:"divTitle"},O={class:"divContent"},z={class:"divAddress"},G={class:"address"},H={class:"name"},j=d(()=>s("i",{class:"el-icon-arrow-right"},null,-1)),U=d(()=>s("div",{class:"divSplit"},null,-1)),J={class:"divFinishTime"},K={class:"order"},Q=d(()=>s("div",{class:"title"},"\u8BA2\u5355\u660E\u7EC6",-1)),R=d(()=>s("div",{class:"divSplit"},null,-1)),W={class:"itemList"},X=d(()=>s("div",{slot:"error",class:"image-slot"},[s("img",{src:S})],-1)),Y={class:"desc"},Z={class:"name"},$={class:"numPrice"},ss={class:"num"},es={class:"price"},ts=d(()=>s("span",{class:"spanMoney"},"\uFFE5",-1)),os={class:"note"},as=d(()=>s("div",{class:"title"},"\u5907\u6CE8",-1)),is={class:"divCart"},ds={class:"divNum"},rs=d(()=>s("span",null,"\uFFE5",-1)),ns=d(()=>s("div",{class:"divPrice"},null,-1));function cs(e,o,n,ls,t,r){const g=h("ArrowLeft"),v=A,f=C,D=h("van-field");return c(),l("div",L,[s("div",q,[s("div",M,[_(v,{onClick:r.goBack},{default:u(()=>[_(g)]),_:1},8,["onClick"]),p(" \u9E21\u4F60\u592A\u7F8E ")])]),s("div",O,[s("div",z,[s("div",{onClick:o[0]||(o[0]=(...a)=>r.toAddressPage&&r.toAddressPage(...a))},[s("div",G,i(t.address.detail),1),s("div",H,[s("span",null,i(t.address.consignee)+i(t.address.sex==="1"?"\u5148\u751F":"\u5973\u58EB"),1),s("span",null,i(t.address.phone),1)]),j]),U,s("div",J,"\u9884\u8BA1"+i(t.finishTime)+"\u9001\u8FBE",1)]),s("div",K,[Q,R,s("div",W,[(c(!0),l(x,null,T(t.cartData,(a,w)=>(c(),l("div",{class:"item",key:w},[_(f,{src:r.imgPathConvert(a.image)},{default:u(()=>[X]),_:2},1032,["src"]),s("div",Y,[s("div",Z,i(a.name),1),s("div",$,[s("span",ss,"x"+i(a.number),1),s("div",es,[ts,p(i(a.amount),1)])])])]))),128))])]),s("div",os,[as,_(D,{modelValue:t.note,"onUpdate:modelValue":o[1]||(o[1]=a=>t.note=a),rows:"2",autosize:"",type:"textarea",maxlength:"50",placeholder:"\u8BF7\u8F93\u5165\u60A8\u9700\u8981\u5907\u6CE8\u7684\u4FE1\u606F","show-word-limit":""},null,8,["modelValue"])])]),s("div",is,[s("div",{class:m({imgCartActive:t.cartData&&t.cartData.length>0,imgCart:!t.cartData||t.cartData.length<1})},null,2),t.cartData&&t.cartData.length>0?(c(),l("div",{key:0,class:m({divGoodsNum:!0,moreGoods:t.cartData&&t.cartData.length>99})},i(r.goodsNum),3)):E("",!0),s("div",ds,[rs,s("span",null,i(r.goodsPrice),1)]),ns,s("div",{class:m({btnSubmitActive:t.cartData&&t.cartData.length>0,btnSubmit:!t.cartData||t.cartData.length<1}),onClick:o[2]||(o[2]=(...a)=>r.goToPaySuccess&&r.goToPaySuccess(...a))},"\u53BB\u652F\u4ED8 ",2)])])}const As=b(B,[["render",cs],["__scopeId","data-v-dd5688b0"]]);export{As as default};
